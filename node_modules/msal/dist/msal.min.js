/*! msal v1.3.2 2020-06-09 */
"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():e.Msal=t()}(window,function(){return n={},o.m=r=[function(e,t,r){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function h(e){return this instanceof h?(this.v=e,this):new h(e)}t.__extends=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t.__assign=function(){return t.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__assign.apply(this,arguments)},t.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},t.__decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,r,a):o(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a},t.__param=function(r,n){return function(e,t){n(e,t,r)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(i,a,s,c){return new(s=s||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,a||[])).next())})},t.__generator=function(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},t.__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},t.__values=i,t.__read=o,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},t.__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},t.__await=h,t.__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=r.apply(e,t||[]),a=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(n){i[n]&&(o[n]=function(r){return new Promise(function(e,t){1<a.push([n,r,e,t])||s(n,r)})})}function s(e,t){try{!function(e){e.value instanceof h?Promise.resolve(e.value.v).then(c,u):l(a[0][2],e)}(i[e](t))}catch(e){l(a[0][3],e)}}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},t.__asyncDelegator=function(n){var e,o;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){e[t]=n[t]?function(e){return(o=!o)?{value:h(n[t](e)),done:"return"===t}:r?r(e):e}:r}},t.__asyncValues=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=o[Symbol.asyncIterator];return t?t.call(o):(o=i(o),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=o[n]&&function(r){return new Promise(function(e,t){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(e,t,(r=o[n](r)).done,r.value)})}}},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i,a,s,c,u=(Object.defineProperty(l,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(l,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(l,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(l,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),l._popUpWidth=483,l._popUpHeight=600,l);function l(){}t.Constants=u,(n=t.ServerHashParamKeys||(t.ServerHashParamKeys={})).SCOPE="scope",n.STATE="state",n.ERROR="error",n.ERROR_DESCRIPTION="error_description",n.ACCESS_TOKEN="access_token",n.ID_TOKEN="id_token",n.EXPIRES_IN="expires_in",n.SESSION_STATE="session_state",n.CLIENT_INFO="client_info",(o=t.TemporaryCacheKeys||(t.TemporaryCacheKeys={})).AUTHORITY="authority",o.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",o.SESSION_STATE="session.state",o.STATE_LOGIN="state.login",o.STATE_ACQ_TOKEN="state.acquireToken",o.STATE_RENEW="state.renew",o.NONCE_IDTOKEN="nonce.idtoken",o.LOGIN_REQUEST="login.request",o.RENEW_STATUS="token.renew.status",o.URL_HASH="urlHash",o.INTERACTION_STATUS="interaction_status",o.REDIRECT_REQUEST="redirect_request",(i=t.PersistentCacheKeys||(t.PersistentCacheKeys={})).IDTOKEN="idtoken",i.CLIENT_INFO="client.info",(a=t.ErrorCacheKeys||(t.ErrorCacheKeys={})).LOGIN_ERROR="login.error",a.ERROR="error",a.ERROR_DESC="error.description",t.AADTrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},(c=s=t.SSOTypes||(t.SSOTypes={})).ACCOUNT="account",c.SID="sid",c.LOGIN_HINT="login_hint",c.ID_TOKEN="id_token",c.ACCOUNT_ID="accountIdentifier",c.HOMEACCOUNT_ID="homeAccountIdentifier",t.BlacklistedEQParams=[s.SID,s.LOGIN_HINT],t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},t.FramePrefix={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"},t.libraryVersion=function(){return"1.3.2"}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(s.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,s.decimalToHex(t[0])+s.decimalToHex(t[1])+s.decimalToHex(t[2])+s.decimalToHex(t[3])+"-"+s.decimalToHex(t[4])+s.decimalToHex(t[5])+"-"+s.decimalToHex(t[6])+s.decimalToHex(t[7])+"-"+s.decimalToHex(t[8])+s.decimalToHex(t[9])+"-"+s.decimalToHex(t[10])+s.decimalToHex(t[11])+s.decimalToHex(t[12])+s.decimalToHex(t[13])+s.decimalToHex(t[14])+s.decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",o=0,i="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(o=16*Math.random()|0),"x"===r[a]?i+=n[o]:"y"===r[a]?(o&=3,i+=n[o|=8]):i+=r[a];return i},s.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},s.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},s.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},s.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},s.deserialize=function(e){function t(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},s);function s(){}t.CryptoUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.isEmpty=function(e){return void 0===e||!e||0===e.length},o);function o(){}t.StringUtils=n},function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0});var r=t(0),n=t(6);i.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. If using B2C, please include this authority in the knownAuthorities config parameter."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}};var o,a=(o=n.ClientAuthError,r.__extends(s,o),s.createNoSetConfigurationError=function(){return new s(i.ClientConfigurationErrorMessage.configurationNotSet.code,""+i.ClientConfigurationErrorMessage.configurationNotSet.desc)},s.createStorageNotSupportedError=function(e){return new s(i.ClientConfigurationErrorMessage.storageNotSupported.code,i.ClientConfigurationErrorMessage.storageNotSupported.desc+" Given location: "+e)},s.createRedirectCallbacksNotSetError=function(){return new s(i.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,i.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},s.createInvalidCallbackObjectError=function(e){return new s(i.ClientConfigurationErrorMessage.invalidCallbackObject.code,i.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+e)},s.createEmptyScopesArrayError=function(e){return new s(i.ClientConfigurationErrorMessage.emptyScopes.code,i.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+e+".")},s.createScopesNonArrayError=function(e){return new s(i.ClientConfigurationErrorMessage.nonArrayScopes.code,i.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+e+".")},s.createClientIdSingleScopeError=function(e){return new s(i.ClientConfigurationErrorMessage.clientScope.code,i.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+e+".")},s.createScopesRequiredError=function(e){return new s(i.ClientConfigurationErrorMessage.scopesRequired.code,i.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+e)},s.createInvalidPromptError=function(e){return new s(i.ClientConfigurationErrorMessage.invalidPrompt.code,i.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+e)},s.createClaimsRequestParsingError=function(e){return new s(i.ClientConfigurationErrorMessage.claimsRequestParsingError.code,i.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+e)},s.createEmptyRequestError=function(){var e=i.ClientConfigurationErrorMessage.emptyRequestError;return new s(e.code,e.desc)},s.createInvalidCorrelationIdError=function(){return new s(i.ClientConfigurationErrorMessage.invalidCorrelationIdError.code,i.ClientConfigurationErrorMessage.invalidCorrelationIdError.desc)},s.createKnownAuthoritiesNotSetError=function(){return new s(i.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code,i.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc)},s.createInvalidAuthorityTypeError=function(){return new s(i.ClientConfigurationErrorMessage.invalidAuthorityType.code,i.ClientConfigurationErrorMessage.invalidAuthorityType.desc)},s.createUntrustedAuthorityError=function(){return new s(i.ClientConfigurationErrorMessage.untrustedAuthority.code,i.ClientConfigurationErrorMessage.untrustedAuthority.desc)},s.createTelemetryConfigError=function(r){var e=i.ClientConfigurationErrorMessage.telemetryConfigError,t=e.code,n=e.desc,o={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new s(t,n+" mising values: "+Object.keys(o).reduce(function(e,t){return r[t]?e:e.concat([t+" ("+o[t]+")"])},[]).join(","))},s.createSsoSilentError=function(){return new s(i.ClientConfigurationErrorMessage.ssoSilentError.code,i.ClientConfigurationErrorMessage.ssoSilentError.desc)},s.createInvalidAuthorityMetadataError=function(){return new s(i.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code,i.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc)},s);function s(e,t){var r=o.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,s.prototype),r}i.ClientConfigurationError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),n=r(10),i=r(3),a=r(2),s=(c.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},c.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(n.ScopeSet.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},c.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);0<=r&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},c.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},c.removeHashFromUrl=function(e){return e.split("#")[0]},c.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return t&&0!==n.length&&n[0]===o.Constants.common&&(n[0]=t),this.constructAuthorityUriFromObject(r,n)},c.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},c.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&0<e.length}),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},c.CanonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!c.endsWith(e,"/")&&(e+="/"),e},c.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},c.urlRemoveQueryStringParameter=function(e,t){if(i.StringUtils.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},c.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):e},c.urlContainsHash=function(e){var t=c.deserializeHash(e);return t.hasOwnProperty(o.ServerHashParamKeys.ERROR_DESCRIPTION)||t.hasOwnProperty(o.ServerHashParamKeys.ERROR)||t.hasOwnProperty(o.ServerHashParamKeys.ACCESS_TOKEN)||t.hasOwnProperty(o.ServerHashParamKeys.ID_TOKEN)},c.deserializeHash=function(e){var t=c.getHashFromUrl(e);return a.CryptoUtils.deserialize(t)},c.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},c);function c(){}t.UrlUtils=s},function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(7),i=t(3);r.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}};var a,s=(a=o.AuthError,n.__extends(c,a),c.createEndpointResolutionError=function(e){var t=r.ClientAuthErrorMessage.endpointResolutionError.desc;return e&&!i.StringUtils.isEmpty(e)&&(t+=" Details: "+e),new c(r.ClientAuthErrorMessage.endpointResolutionError.code,t)},c.createMultipleMatchingTokensInCacheError=function(e){return new c(r.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+e+": "+r.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},c.createMultipleAuthoritiesInCacheError=function(e){return new c(r.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+r.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},c.createPopupWindowError=function(e){var t=r.ClientAuthErrorMessage.popUpWindowError.desc;return e&&!i.StringUtils.isEmpty(e)&&(t+=" Details: "+e),new c(r.ClientAuthErrorMessage.popUpWindowError.code,t)},c.createTokenRenewalTimeoutError=function(){return new c(r.ClientAuthErrorMessage.tokenRenewalError.code,r.ClientAuthErrorMessage.tokenRenewalError.desc)},c.createInvalidIdTokenError=function(e){return new c(r.ClientAuthErrorMessage.invalidIdToken.code,r.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+e)},c.createInvalidStateError=function(e,t){return new c(r.ClientAuthErrorMessage.invalidStateError.code,r.ClientAuthErrorMessage.invalidStateError.desc+" "+e+", state expected : "+t+".")},c.createNonceMismatchError=function(e,t){return new c(r.ClientAuthErrorMessage.nonceMismatchError.code,r.ClientAuthErrorMessage.nonceMismatchError.desc+" "+e+", nonce expected : "+t+".")},c.createLoginInProgressError=function(){return new c(r.ClientAuthErrorMessage.loginProgressError.code,r.ClientAuthErrorMessage.loginProgressError.desc)},c.createAcquireTokenInProgressError=function(){return new c(r.ClientAuthErrorMessage.acquireTokenProgressError.code,r.ClientAuthErrorMessage.acquireTokenProgressError.desc)},c.createUserCancelledError=function(){return new c(r.ClientAuthErrorMessage.userCancelledError.code,r.ClientAuthErrorMessage.userCancelledError.desc)},c.createErrorInCallbackFunction=function(e){return new c(r.ClientAuthErrorMessage.callbackError.code,r.ClientAuthErrorMessage.callbackError.desc+" "+e+".")},c.createUserLoginRequiredError=function(){return new c(r.ClientAuthErrorMessage.userLoginRequiredError.code,r.ClientAuthErrorMessage.userLoginRequiredError.desc)},c.createUserDoesNotExistError=function(){return new c(r.ClientAuthErrorMessage.userDoesNotExistError.code,r.ClientAuthErrorMessage.userDoesNotExistError.desc)},c.createClientInfoDecodingError=function(e){return new c(r.ClientAuthErrorMessage.clientInfoDecodingError.code,r.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+e)},c.createClientInfoNotPopulatedError=function(e){return new c(r.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,r.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},c.createIdTokenNullOrEmptyError=function(e){return new c(r.ClientAuthErrorMessage.nullOrEmptyIdToken.code,r.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},c.createIdTokenParsingError=function(e){return new c(r.ClientAuthErrorMessage.idTokenNotParsed.code,r.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+e)},c.createTokenEncodingError=function(e){return new c(r.ClientAuthErrorMessage.tokenEncodingError.code,r.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+e)},c.createInvalidInteractionTypeError=function(){return new c(r.ClientAuthErrorMessage.invalidInteractionType.code,r.ClientAuthErrorMessage.invalidInteractionType.desc)},c.createCacheParseError=function(e){var t="invalid key: "+e+", "+r.ClientAuthErrorMessage.cacheParseError.desc;return new c(r.ClientAuthErrorMessage.cacheParseError.code,t)},c.createBlockTokenRequestsInHiddenIframeError=function(){return new c(r.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code,r.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc)},c);function c(e,t){var r=a.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,c.prototype),r}r.ClientAuthError=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};var o,i=(o=Error,n.__extends(a,o),a.createUnexpectedError=function(e){return new a(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+e)},a.createNoWindowObjectError=function(e){return new a(t.AuthErrorMessage.noWindowObjectError.code,t.AuthErrorMessage.noWindowObjectError.desc+" "+e)},a);function a(e,t){var r=o.call(this,t)||this;return Object.setPrototypeOf(r,a.prototype),r.errorCode=e,r.errorMessage=t,r.name="AuthError",r}t.AuthError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(4),a=r(21),s=r(5),c=i.__importDefault(r(22));(n=t.AuthorityType||(t.AuthorityType={}))[n.Aad=0]="Aad",n[n.Adfs=1]="Adfs",n[n.B2C=2]="B2C";var u=(Object.defineProperty(l.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),l.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(l.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=s.UrlUtils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=s.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),l.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw o.ClientConfigurationErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw o.ClientConfigurationErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw o.ClientConfigurationErrorMessage.authorityUriInvalidPath},l.prototype.DiscoverEndpoints=function(e,t,r){var n=new a.XhrClient,o=new c.default(r,"openIdConfigurationEndpoint");return o.url=e,o.httpMethod="GET",t.startEvent(o),n.sendRequestAsync(e,"GET",!0).then(function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw o.serverErrorCode=e,t.stopEvent(o),e})},l.prototype.resolveEndpointsAsync=function(n,o){return i.__awaiter(this,void 0,Promise,function(){var t,r;return i.__generator(this,function(e){switch(e.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync(n,o)];case 1:return t=e.sent(),[4,(r=this).DiscoverEndpoints(t,n,o)];case 2:return r.tenantDiscoveryResponse=e.sent(),[2,this.tenantDiscoveryResponse]}})})},l.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},l);function l(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}t.Authority=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_NAME_PREFIX="msal.",t.EVENT_NAME_KEY="event_name",t.START_TIME_KEY="start_time",t.ELAPSED_TIME_KEY="elapsed_time",t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},t.TENANT_PLACEHOLDER="<tenant>"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(1),i=(a.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(-1<r.indexOf(n[o].toLowerCase()))return!0;return!1},a.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return 0<=r.indexOf(e.toString().toLowerCase())})},a.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},a.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},a.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==r})},a.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},a.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw n.ClientConfigurationError.createScopesNonArrayError(e);if(e.length<1)throw n.ClientConfigurationError.createEmptyScopesArrayError(e.toString());if(-1<e.indexOf(r)&&1<e.length)throw n.ClientConfigurationError.createClientIdSingleScopeError(e.toString())}else if(t)throw n.ClientConfigurationError.createScopesRequiredError(e)},a.getScopeFromState=function(e){if(e){var t=e.indexOf(o.Constants.resourceDelimiter);if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},a.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},a);function a(){}t.ScopeSet=i},function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var o=t(1),i=t(9),r=t(2),a=t(5);n.scrubTenantFromUri=function(e){var t=a.UrlUtils.GetUrlComponents(e);if(!o.AADTrustedHostList[t.HostNameAndPort.toLocaleLowerCase()])return e;var r=t.PathSegments;if(r&&2<=r.length){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]=i.TENANT_PLACEHOLDER)}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},n.hashPersonalIdentifier=function(e){return r.CryptoUtils.base64Encode(e)},n.prependEventNamePrefix=function(e){return""+i.EVENT_NAME_PREFIX+(e||"")},n.supportsBrowserPerformance=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},n.endBrowserPerformanceMeasurement=function(e,t,r){n.supportsBrowserPerformance()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},n.startBrowserPerformanceMeasurement=function(e){n.supportsBrowserPerformance()&&window.performance.mark(e)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(9),a=r(11),s=r(2),c=(u.prototype.setElapsedTime=function(e){this.event[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=e},u.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp),a.endBrowserPerformanceMeasurement(this.displayName,this.perfStartMark,this.perfEndMark)},u.prototype.start=function(){this.startTimestamp=Date.now(),this.event[a.prependEventNamePrefix(i.START_TIME_KEY)]=this.startTimestamp,a.startBrowserPerformanceMeasurement(this.perfStartMark)},Object.defineProperty(u.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"eventName",{get:function(){return this.event[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),u.prototype.get=function(){return n.__assign({},this.event,{eventId:this.eventId})},Object.defineProperty(u.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),u);function u(e,t,r){var n;this.eventId=s.CryptoUtils.createNewGuid(),this.label=r,this.event=((n={})[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]=e,n[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=-1,n[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,n)}t.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var c,n,i=r(3),a=r(1);(n=c=t.LogLevel||(t.LogLevel={}))[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose";var o=(s.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=i.StringUtils.isEmpty(this.correlationId)?o+":"+a.libraryVersion()+"-"+c[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-"+a.libraryVersion()+"-"+c[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},s.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},s.prototype.error=function(e){this.logMessage(c.Error,e,!1)},s.prototype.errorPii=function(e){this.logMessage(c.Error,e,!0)},s.prototype.warning=function(e){this.logMessage(c.Warning,e,!1)},s.prototype.warningPii=function(e){this.logMessage(c.Warning,e,!0)},s.prototype.info=function(e){this.logMessage(c.Info,e,!1)},s.prototype.infoPii=function(e){this.logMessage(c.Info,e,!0)},s.prototype.verbose=function(e){this.logMessage(c.Verbose,e,!1)},s.prototype.verbosePii=function(e){this.logMessage(c.Verbose,e,!0)},s.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},s);function s(e,t){void 0===t&&(t={}),this.level=c.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?c.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}t.Logger=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};var i,a=(i=o.AuthError,n.__extends(s,i),s.createServerUnavailableError=function(){return new s(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},s.createUnknownServerError=function(e){return new s(t.ServerErrorMessage.unknownServerError.code,e)},s);function s(e,t){var r=i.call(this,e,t)||this;return r.name="ServerError",Object.setPrototypeOf(r,s.prototype),r}t.ServerError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var m=r(0),E=r(29),v=r(30),C=r(16),T=r(31),I=r(32),_=r(33),S=r(18),A=r(10),w=r(3),b=r(19),y=r(17),P=r(20),R=r(5),O=r(36),k=r(37),N=r(38),n=r(23),a=r(4),U=r(7),M=r(6),x=r(14),K=r(24),L=r(25),s=m.__importDefault(r(41)),c=r(26),q=r(1),u=r(2),H="id_token",o="token",i="id_token token",l=(Object.defineProperty(h.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=N.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),h.prototype.getAuthorityInstance=function(){return this.authorityInstance},h.prototype.handleRedirectCallback=function(e,t){if(!e)throw a.ClientConfigurationError.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(q.Constants.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(q.Constants.interactionTypeRedirect,this.redirectResponse)},h.prototype.urlContainsHash=function(e){return R.UrlUtils.urlContainsHash(e)},h.prototype.authResponseHandler=function(e,t,r){if(e===q.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==q.Constants.interactionTypePopup)throw M.ClientAuthError.createInvalidInteractionTypeError();r(t)}},h.prototype.authErrorHandler=function(e,t,r,n){if(this.cacheStorage.removeItem(q.TemporaryCacheKeys.INTERACTION_STATUS),e===q.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==q.Constants.interactionTypePopup)throw M.ClientAuthError.createInvalidInteractionTypeError();n(t)}},h.prototype.loginRedirect=function(e){var t=O.RequestUtils.validateRequest(e,!0,this.clientId,q.Constants.interactionTypeRedirect);this.acquireTokenInteractive(q.Constants.interactionTypeRedirect,!0,t,null,null)},h.prototype.acquireTokenRedirect=function(e){var t=O.RequestUtils.validateRequest(e,!1,this.clientId,q.Constants.interactionTypeRedirect);this.acquireTokenInteractive(q.Constants.interactionTypeRedirect,!1,t,null,null)},h.prototype.loginPopup=function(e){var r=this,n=O.RequestUtils.validateRequest(e,!0,this.clientId,q.Constants.interactionTypePopup),t=this.telemetryManager.createAndStartApiEvent(n.correlationId,c.API_EVENT_IDENTIFIER.LoginPopup);return new Promise(function(e,t){r.acquireTokenInteractive(q.Constants.interactionTypePopup,!0,n,e,t)}).then(function(e){return r.telemetryManager.stopAndFlushApiEvent(n.correlationId,t,!0),e}).catch(function(e){throw r.cacheStorage.resetTempCacheItems(n.state),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,t,!1,e.errorCode),e})},h.prototype.acquireTokenPopup=function(e){var r=this;this.logger.verbose("AcquireTokenPopup has been called");var n=O.RequestUtils.validateRequest(e,!1,this.clientId,q.Constants.interactionTypePopup),t=this.telemetryManager.createAndStartApiEvent(n.correlationId,c.API_EVENT_IDENTIFIER.AcquireTokenPopup);return new Promise(function(e,t){r.acquireTokenInteractive(q.Constants.interactionTypePopup,!1,n,e,t)}).then(function(e){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,t,!0),e}).catch(function(e){throw r.cacheStorage.resetTempCacheItems(n.state),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,t,!1,e.errorCode),e})},h.prototype.acquireTokenInteractive=function(t,r,n,o,i){var a=this;this.logger.verbose("AcquireTokenInteractive has been called"),b.WindowUtils.blockReloadInHiddenIframes();var e,s=this.cacheStorage.getItem(q.TemporaryCacheKeys.INTERACTION_STATUS);if(t===q.Constants.interactionTypeRedirect&&this.cacheStorage.setItem(q.TemporaryCacheKeys.REDIRECT_REQUEST,""+q.Constants.inProgress+q.Constants.resourceDelimiter+n.state),s===q.Constants.inProgress){var c=r?M.ClientAuthError.createLoginInProgressError():M.ClientAuthError.createAcquireTokenInProgressError(),u=L.buildResponseStateOnly(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(t,c,u,i)}if(n&&n.account&&!r?(e=n.account,this.logger.verbose("Account set from request")):(e=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),e||C.ServerRequestParameters.isSSOParam(n))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(e,t,r,n,o,i);else{if(!r)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),u=L.buildResponseStateOnly(this.getAccountState(n.state)),this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(t,M.ClientAuthError.createUserLoginRequiredError(),u,i);if(this.extractADALIdToken()&&!n.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var l=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(e){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(t,e,o)},function(e){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+e),a.acquireTokenHelper(null,t,r,n,o,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,t,r,n,o,i)}},h.prototype.acquireTokenHelper=function(h,d,p,f,g,y){return m.__awaiter(this,void 0,Promise,function(){var t,r,n,o,i,a,s,c,u,l;return m.__generator(this,function(e){switch(e.label){case 0:this.cacheStorage.setItem(q.TemporaryCacheKeys.INTERACTION_STATUS,q.Constants.inProgress),t=f.scopes?f.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),n=f&&f.authority?N.AuthorityFactory.CreateInstance(f.authority,this.config.auth.validateAuthority,f.authorityMetadata):this.authorityInstance,e.label=1;case 1:return e.trys.push([1,11,,12]),n.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,N.AuthorityFactory.saveMetadataFromNetwork(n,this.telemetryManager,f.correlationId)]);case 2:return e.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),e.label=4;case 4:if(i=p?H:this.getTokenType(h,f.scopes,!1),a=f.redirectStartPage||window.location.href,r=new C.ServerRequestParameters(n,this.clientId,i,this.getRedirectUri(f&&f.redirectUri),f.scopes,f.state,f.correlationId),this.updateCacheEntries(r,h,p,a),r.populateQueryParams(h,f),s=R.UrlUtils.createNavigateUrl(r)+q.Constants.response_mode_fragment,d===q.Constants.interactionTypeRedirect)p||this.cacheStorage.setItem(""+q.TemporaryCacheKeys.STATE_ACQ_TOKEN+q.Constants.resourceDelimiter+f.state,r.state,this.inCookie);else{if(d!==q.Constants.interactionTypePopup)throw M.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(r.state),window.requestType=p?q.Constants.login:q.Constants.renewToken,this.registerCallback(r.state,t,g,y)}if(d!==q.Constants.interactionTypePopup)return[3,9];try{o=this.openPopup(s,"msal",q.Constants.popUpWidth,q.Constants.popUpHeight),b.WindowUtils.trackPopup(o)}catch(e){if(this.logger.info(M.ClientAuthErrorMessage.popUpWindowError.code+":"+M.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR,M.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR_DESC,M.ClientAuthErrorMessage.popUpWindowError.desc),y)return y(M.ClientAuthError.createPopupWindowError()),[2]}if(!o)return[3,8];e.label=5;case 5:return e.trys.push([5,7,,8]),[4,b.WindowUtils.monitorWindowForHash(o,this.config.system.loadFrameTimeout,s,this.logger)];case 6:return c=e.sent(),this.handleAuthenticationResponse(c),this.cacheStorage.removeItem(q.TemporaryCacheKeys.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",c),b.WindowUtils.closePopups()),[3,8];case 7:return u=e.sent(),y&&y(u),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",u.errorCode+q.Constants.resourceDelimiter+u.errorMessage):(this.cacheStorage.removeItem(q.TemporaryCacheKeys.INTERACTION_STATUS),o.close()),[3,8];case 8:return[3,10];case 9:f.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==f.onRedirectNavigate(s)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(s)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(s)),e.label=10;case 10:return[3,12];case 11:return l=e.sent(),this.logger.error(l),this.cacheStorage.resetTempCacheItems(f.state),this.authErrorHandler(d,M.ClientAuthError.createEndpointResolutionError(l.toString),L.buildResponseStateOnly(f.state),y),o&&o.close(),[3,12];case 12:return[2]}})})},h.prototype.ssoSilent=function(e){if(!e)throw a.ClientConfigurationError.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw a.ClientConfigurationError.createSsoSilentError();return this.acquireTokenSilent(m.__assign({},e,{scopes:[this.clientId]}))},h.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var f=O.RequestUtils.validateRequest(e,!1,this.clientId,q.Constants.interactionTypeSilent),r=this.telemetryManager.createAndStartApiEvent(f.correlationId,c.API_EVENT_IDENTIFIER.AcquireTokenSilent),g=O.RequestUtils.createRequestSignature(f);return new Promise(function(d,p){return m.__awaiter(t,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u,l,h;return m.__generator(this,function(e){switch(e.label){case 0:if(b.WindowUtils.blockReloadInHiddenIframes(),t=f.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),f.account?(r=f.account,this.logger.verbose("Account set from request")):(r=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),n=this.cacheStorage.getItem(q.Constants.adalIdToken),!r&&!f.sid&&!f.loginHint&&w.StringUtils.isEmpty(n))return this.logger.info("User login is required"),[2,p(M.ClientAuthError.createUserLoginRequiredError())];if(o=this.getTokenType(r,f.scopes,!0),this.logger.verbose("Response type: "+o),i=new C.ServerRequestParameters(N.AuthorityFactory.CreateInstance(f.authority,this.config.auth.validateAuthority,f.authorityMetadata),this.clientId,o,this.getRedirectUri(f.redirectUri),f.scopes,f.state,f.correlationId),this.logger.verbose("Finished building server authentication request"),C.ServerRequestParameters.isSSOParam(f)||r?(i.populateQueryParams(r,f,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):r||w.StringUtils.isEmpty(n)?this.logger.verbose("No additional query parameters added"):(a=y.TokenUtils.extractIdToken(n),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),i.populateQueryParams(r,null,a,!0)),!(s=f.claimsRequest||i.claimsValue)&&!f.forceRefresh)try{u=this.getCachedToken(i,r)}catch(e){c=e}return u?(this.logger.verbose("Token is already in cache for scope: "+t),d(u),[2,null]):[3,1];case 1:return c?(this.logger.infoPii(c.errorCode+":"+c.errorMessage),p(c),[2,null]):[3,2];case 2:l=void 0,l=s?"Skipped cache lookup since claims were given":f.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope: "+t,this.logger.verbose(l),i.authorityInstance||(i.authorityInstance=f.authority?N.AuthorityFactory.CreateInstance(f.authority,this.config.auth.validateAuthority,f.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+i.authority),e.label=3;case 3:return e.trys.push([3,7,,8]),i.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,N.AuthorityFactory.saveMetadataFromNetwork(i.authorityInstance,this.telemetryManager,f.correlationId)]);case 4:return e.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),e.label=6;case 6:return window.activeRenewals[g]?(this.logger.verbose("Renew token for scope and authority: "+g+" is in progress. Registering callback"),this.registerCallback(window.activeRenewals[g],g,d,p)):f.scopes&&-1<f.scopes.indexOf(this.clientId)&&1===f.scopes.length?(this.logger.verbose("Renewing idToken"),this.silentLogin=!0,this.renewIdToken(g,d,p,r,i)):(this.logger.verbose("Renewing accesstoken"),this.renewToken(g,d,p,r,i)),[3,8];case 7:return h=e.sent(),this.logger.error(h),p(M.ClientAuthError.createEndpointResolutionError(h.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(f.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(f.state),t.telemetryManager.stopAndFlushApiEvent(f.correlationId,r,!1,e.errorCode),e})},h.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,u=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c+", scrollbars=yes");if(!l)throw M.ClientAuthError.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.removeItem(q.TemporaryCacheKeys.INTERACTION_STATUS),M.ClientAuthError.createPopupWindowError(e.toString())}},h.prototype.loadIframeTimeout=function(a,s,c){return m.__awaiter(this,void 0,Promise,function(){var t,r,n,o,i;return m.__generator(this,function(e){switch(e.label){case 0:return t=window.activeRenewals[c],this.logger.verbosePii("Set loading state to pending for: "+c+":"+t),this.cacheStorage.setItem(""+q.TemporaryCacheKeys.RENEW_STATUS+q.Constants.resourceDelimiter+t,q.Constants.inProgress),this.config.system.navigateFrameWait?[4,b.WindowUtils.loadFrame(a,s,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return n=e.sent(),[3,3];case 2:n=b.WindowUtils.loadFrameSync(a,s,this.logger),e.label=3;case 3:r=n,e.label=4;case 4:return e.trys.push([4,6,,7]),[4,b.WindowUtils.monitorWindowForHash(r.contentWindow,this.config.system.loadFrameTimeout,a,this.logger,!0)];case 5:return(o=e.sent())&&this.handleAuthenticationResponse(o),[3,7];case 6:throw i=e.sent(),this.cacheStorage.getItem(""+q.TemporaryCacheKeys.RENEW_STATUS+q.Constants.resourceDelimiter+t)===q.Constants.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+c+":"+t),t&&window.callbackMappedToRenewStates[t]&&window.callbackMappedToRenewStates[t](null,i),this.cacheStorage.removeItem(""+q.TemporaryCacheKeys.RENEW_STATUS+q.Constants.resourceDelimiter+t)),b.WindowUtils.removeHiddenIframe(r),i;case 7:return b.WindowUtils.removeHiddenIframe(r),[2]}})})},h.prototype.navigateWindow=function(e,t){if(!e||w.StringUtils.isEmpty(e))throw this.logger.info("Navigate url is empty"),U.AuthError.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},h.prototype.registerCallback=function(n,o,e,t){var i=this;window.activeRenewals[o]=n,window.promiseMappedToRenewStates[n]||(window.promiseMappedToRenewStates[n]=[]),window.promiseMappedToRenewStates[n].push({resolve:e,reject:t}),window.callbackMappedToRenewStates[n]||(window.callbackMappedToRenewStates[n]=function(e,t){window.activeRenewals[o]=null;for(var r=0;r<window.promiseMappedToRenewStates[n].length;++r)try{if(t)window.promiseMappedToRenewStates[n][r].reject(t);else{if(!e)throw i.cacheStorage.resetTempCacheItems(n),U.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[n][r].resolve(e)}}catch(e){i.logger.warning(e)}window.promiseMappedToRenewStates[n]=null,window.callbackMappedToRenewStates[n]=null})},h.prototype.logout=function(e){this.logoutAsync(e)},h.prototype.logoutAsync=function(s){return m.__awaiter(this,void 0,Promise,function(){var t,r,n,o,i,a;return m.__generator(this,function(e){switch(e.label){case 0:t=s||u.CryptoUtils.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,c.API_EVENT_IDENTIFIER.Logout),this.clearCache(),this.account=null,e.label=1;case 1:return e.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,N.AuthorityFactory.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,s)]);case 2:return e.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),e.label=4;case 4:return n="client-request-id="+t,o=this.getPostLogoutRedirectUri()?"&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()):"",i=this.authorityInstance.EndSessionEndpoint?this.authorityInstance.EndSessionEndpoint+"?"+n+o:this.authority+"oauth2/v2.0/logout?"+n+o,this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.navigateWindow(i),[3,6];case 5:return a=e.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}})})},h.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(q.Constants.clientId,q.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},h.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(q.Constants.clientId,q.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},h.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),R.UrlUtils.urlContainsHash(e)},h.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t=t||this.getResponseState(e);try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===q.Constants.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=q.ServerHashParamKeys.ACCESS_TOKEN):t.requestType===q.Constants.login&&(n.tokenType=q.ServerHashParamKeys.ID_TOKEN),!r)return void(this.redirectResponse=n)}else if(!r)return this.redirectResponse=L.buildResponseStateOnly(i),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(t.state);r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),M.ClientAuthError.createErrorInCallbackFunction(e.toString())}},h.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=this.getResponseState(t),n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),b.WindowUtils.closePopups()},h.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),window.location.hash="";var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){var r=this.cacheStorage.getItem(""+q.TemporaryCacheKeys.LOGIN_REQUEST+q.Constants.resourceDelimiter+t.state,this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");var n=R.UrlUtils.removeHashFromUrl(window.location.href),o=R.UrlUtils.removeHashFromUrl(r);if(n!==o)return void window.location.assign(""+o+e);var i=R.UrlUtils.GetUrlComponents(r);i.Hash&&(window.location.hash=i.Hash)}this.processCallBack(e,t,null)},h.prototype.getResponseState=function(e){var t,r=R.UrlUtils.deserializeHash(e);if(!r)throw U.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(q.ServerHashParamKeys.STATE))throw U.AuthError.createUnexpectedError("Hash does not contain state.");var n=O.RequestUtils.parseLibraryState(r.state);if((t={requestType:q.Constants.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(""+q.TemporaryCacheKeys.STATE_LOGIN+q.Constants.resourceDelimiter+t.state,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=q.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(""+q.TemporaryCacheKeys.STATE_ACQ_TOKEN+q.Constants.resourceDelimiter+t.state,this.inCookie))return t.requestType=q.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){t.stateMatch=!0;break}}return t},h.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++)c=(s=o[a]).key.scopes.split(" "),A.ScopeSet.containsScope(c,n)&&R.UrlUtils.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s);if(0===i.length)return null;if(1!==i.length)throw M.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var s,c=(s=o[a]).key.scopes.split(" ");A.ScopeSet.containsScope(c,n)&&i.push(s)}if(1===i.length)r=i[0],e.authorityInstance=N.AuthorityFactory.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(1<i.length)throw M.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());var u=this.getUniqueAuthority(o,"authority");if(1<u.length)throw M.ClientAuthError.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=N.AuthorityFactory.CreateInstance(u[0],this.config.auth.validateAuthority)}}if(null==r)return null;var l=Number(r.value.expiresIn),h=this.config.system.tokenRenewalOffsetSeconds||300;if(l&&l>P.TimeUtils.now()+h){var d=new I.IdToken(r.value.idToken);if(!t&&!(t=this.getAccount()))throw U.AuthError.createUnexpectedError("Account should not be null here.");var p=this.getAccountState(e.state),f={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?q.ServerHashParamKeys.ID_TOKEN:q.ServerHashParamKeys.ACCESS_TOKEN,idToken:d,idTokenClaims:d.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*l),account:t,accountState:p,fromCache:!0};return k.ResponseUtils.setResponseIdToken(f,d),f}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null},h.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},h.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(q.Constants.adalIdToken);return w.StringUtils.isEmpty(e)?null:y.TokenUtils.extractIdToken(e)},h.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("renewToken is called for scope and authority: "+e);var i=b.WindowUtils.generateFrameName(q.FramePrefix.TOKEN_FRAME,e);b.WindowUtils.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("Renew token Expected state: "+o.state);var a=R.UrlUtils.urlRemoveQueryStringParameter(R.UrlUtils.createNavigateUrl(o),q.Constants.prompt)+q.Constants.prompt_none+q.Constants.response_mode_fragment;window.renewStates.push(o.state),window.requestType=q.Constants.renewToken,this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},h.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=b.WindowUtils.generateFrameName(q.FramePrefix.ID_TOKEN_FRAME,e);b.WindowUtils.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=R.UrlUtils.urlRemoveQueryStringParameter(R.UrlUtils.createNavigateUrl(o),q.Constants.prompt)+q.Constants.prompt_none+q.Constants.response_mode_fragment;this.silentLogin?(window.requestType=q.Constants.login,this.silentAuthenticationState=o.state):(window.requestType=q.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},h.prototype.saveAccessToken=function(e,t,r,n,o){var i,a,s=m.__assign({},e),c=new T.ClientInfo(n);if(r.hasOwnProperty(q.ServerHashParamKeys.SCOPE)){for(var u=(i=r[q.ServerHashParamKeys.SCOPE]).split(" "),l=this.cacheStorage.getAllAccessTokens(this.clientId,t),h=0;h<l.length;h++){var d=l[h];if(d.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var p=d.key.scopes.split(" ");A.ScopeSet.isIntersectingScopes(p,u)&&this.cacheStorage.removeItem(JSON.stringify(d.key))}}var f=P.TimeUtils.parseExpiresIn(r[q.ServerHashParamKeys.EXPIRES_IN]);a=O.RequestUtils.parseLibraryState(r[q.ServerHashParamKeys.STATE]).ts+f;var g=new E.AccessTokenKey(t,this.clientId,i,c.uid,c.utid),y=new v.AccessTokenValue(r[q.ServerHashParamKeys.ACCESS_TOKEN],o.rawIdToken,a.toString(),n);this.cacheStorage.setItem(JSON.stringify(g),JSON.stringify(y)),s.accessToken=r[q.ServerHashParamKeys.ACCESS_TOKEN],s.scopes=u}else i=this.clientId,g=new E.AccessTokenKey(t,this.clientId,i,c.uid,c.utid),a=Number(o.expiration),y=new v.AccessTokenValue(r[q.ServerHashParamKeys.ID_TOKEN],r[q.ServerHashParamKeys.ID_TOKEN],a.toString(),n),this.cacheStorage.setItem(JSON.stringify(g),JSON.stringify(y)),s.scopes=[i],s.accessToken=r[q.ServerHashParamKeys.ID_TOKEN];return a?s.expiresOn=new Date(1e3*a):this.logger.error("Could not parse expiresIn parameter"),s},h.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=R.UrlUtils.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(q.ServerHashParamKeys.ERROR_DESCRIPTION)||o.hasOwnProperty(q.ServerHashParamKeys.ERROR)){if(this.logger.infoPii("Error :"+o[q.ServerHashParamKeys.ERROR]+"; Error description:"+o[q.ServerHashParamKeys.ERROR_DESCRIPTION]),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR,o[q.ServerHashParamKeys.ERROR]),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR_DESC,o[q.ServerHashParamKeys.ERROR_DESCRIPTION]),t.requestType===q.Constants.login&&(this.cacheStorage.setItem(q.ErrorCacheKeys.LOGIN_ERROR,o[q.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+o[q.ServerHashParamKeys.ERROR]),i=_.AuthCache.generateAuthorityKey(t.state)),t.requestType===q.Constants.renewToken){i=_.AuthCache.generateAuthorityKey(t.state);var c=this.getAccount(),u=void 0;u=c&&!w.StringUtils.isEmpty(c.homeAccountIdentifier)?c.homeAccountIdentifier:q.Constants.no_account,a=_.AuthCache.generateAcquireTokenAccountKey(u,t.state)}var l=o[q.ServerHashParamKeys.ERROR],h=o[q.ServerHashParamKeys.ERROR_DESCRIPTION];r=K.InteractionRequiredAuthError.isInteractionRequiredError(l)||K.InteractionRequiredAuthError.isInteractionRequiredError(h)?new K.InteractionRequiredAuthError(o[q.ServerHashParamKeys.ERROR],o[q.ServerHashParamKeys.ERROR_DESCRIPTION]):new x.ServerError(o[q.ServerHashParamKeys.ERROR],o[q.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(q.ServerHashParamKeys.SESSION_STATE)&&this.cacheStorage.setItem(""+q.TemporaryCacheKeys.SESSION_STATE+q.Constants.resourceDelimiter+t.state,o[q.ServerHashParamKeys.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var d="";if(o.hasOwnProperty(q.ServerHashParamKeys.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[q.ServerHashParamKeys.ACCESS_TOKEN],o.hasOwnProperty(q.ServerHashParamKeys.SCOPE)&&(n.scopes=o[q.ServerHashParamKeys.SCOPE].split(" ")),o.hasOwnProperty(q.ServerHashParamKeys.ID_TOKEN)?(s=new I.IdToken(o[q.ServerHashParamKeys.ID_TOKEN]),n.idToken=s,n.idTokenClaims=s.claims):(s=new I.IdToken(this.cacheStorage.getItem(q.PersistentCacheKeys.IDTOKEN)),n=k.ResponseUtils.setResponseIdToken(n,s));var p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);if(!o.hasOwnProperty(q.ServerHashParamKeys.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),M.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");d=o[q.ServerHashParamKeys.CLIENT_INFO],n.account=S.Account.createAccount(s,new T.ClientInfo(d));var f=void 0;f=n.account&&!w.StringUtils.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:q.Constants.no_account,a=_.AuthCache.generateAcquireTokenAccountKey(f,t.state);var g=_.AuthCache.generateAcquireTokenAccountKey(q.Constants.no_account,t.state),y=this.cacheStorage.getItem(a),m=void 0;w.StringUtils.isEmpty(y)?w.StringUtils.isEmpty(this.cacheStorage.getItem(g))||(n=this.saveAccessToken(n,p,o,d,s)):(m=JSON.parse(y),n.account&&m&&S.Account.compareAccounts(n.account,m)?(n=this.saveAccessToken(n,p,o,d,s),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}o.hasOwnProperty(q.ServerHashParamKeys.ID_TOKEN)&&(this.logger.info("Fragment has id token"),s=new I.IdToken(o[q.ServerHashParamKeys.ID_TOKEN]),n=k.ResponseUtils.setResponseIdToken(n,s),o.hasOwnProperty(q.ServerHashParamKeys.CLIENT_INFO)?d=o[q.ServerHashParamKeys.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD"),p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s),this.account=S.Account.createAccount(s,new T.ClientInfo(d)),n.account=this.account,s&&s.nonce?s.nonce!==this.cacheStorage.getItem(""+q.TemporaryCacheKeys.NONCE_IDTOKEN+q.Constants.resourceDelimiter+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(q.ErrorCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(""+q.TemporaryCacheKeys.NONCE_IDTOKEN+q.Constants.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(""+q.TemporaryCacheKeys.NONCE_IDTOKEN+q.Constants.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+s.nonce),r=M.ClientAuthError.createNonceMismatchError(this.cacheStorage.getItem(""+q.TemporaryCacheKeys.NONCE_IDTOKEN+q.Constants.resourceDelimiter+t.state,this.inCookie),s.nonce)):(this.cacheStorage.setItem(q.PersistentCacheKeys.IDTOKEN,o[q.ServerHashParamKeys.ID_TOKEN]),this.cacheStorage.setItem(q.PersistentCacheKeys.CLIENT_INFO,d),this.saveAccessToken(n,p,o,d,s)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=M.ClientAuthError.createInvalidIdTokenError(s),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR_DESC,r.errorMessage)))}else{i=t.state,a=t.state;var E=this.cacheStorage.getItem(""+q.TemporaryCacheKeys.STATE_LOGIN+q.Constants.resourceDelimiter+t.state,this.inCookie);this.logger.error("State Mismatch.Expected State: "+E+",Actual State: "+t.state),r=M.ClientAuthError.createInvalidStateError(t.state,E),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(q.ErrorCacheKeys.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(""+q.TemporaryCacheKeys.RENEW_STATUS+q.Constants.resourceDelimiter+t.state),this.cacheStorage.resetTempCacheItems(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw U.AuthError.createUnexpectedError("Response is null");return n},h.prototype.populateAuthority=function(e,t,r,n){var o=_.AuthCache.generateAuthorityKey(e),i=r.getItem(o,t);return w.StringUtils.isEmpty(i)?i:R.UrlUtils.replaceTenantPath(i,n.tenantId)},h.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(q.PersistentCacheKeys.IDTOKEN),t=this.cacheStorage.getItem(q.PersistentCacheKeys.CLIENT_INFO);if(w.StringUtils.isEmpty(e)||w.StringUtils.isEmpty(t))return null;var r=new I.IdToken(e),n=new T.ClientInfo(t);return this.account=S.Account.createAccount(r,n),this.account},h.prototype.getAccountState=function(e){if(e){var t=e.indexOf(q.Constants.resourceDelimiter);if(-1<t&&t+1<e.length)return e.substring(t+1)}return e},h.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(q.Constants.clientId,q.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=new I.IdToken(t[r].value.idToken),o=new T.ClientInfo(t[r].value.homeAccountIdentifier),i=S.Account.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},h.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},h.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},h.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:N.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e,!0),s=new C.ServerRequestParameters(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},h.prototype.getScopesForEndpoint=function(e){if(0<this.config.framework.unprotectedResources.length)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(-1<e.indexOf(this.config.framework.unprotectedResources[t]))return null;if(0<this.config.framework.protectedResourceMap.size)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(-1<e.indexOf(o))return this.config.framework.protectedResourceMap.get(o)}return-1<e.indexOf("http://")||-1<e.indexOf("https://")?R.UrlUtils.getHostFromUri(e)===R.UrlUtils.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},h.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(q.TemporaryCacheKeys.INTERACTION_STATUS)===q.Constants.inProgress},h.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(q.TemporaryCacheKeys.INTERACTION_STATUS,q.Constants.inProgress):this.cacheStorage.removeItem(q.TemporaryCacheKeys.INTERACTION_STATUS)},h.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},h.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(q.TemporaryCacheKeys.INTERACTION_STATUS)===q.Constants.inProgress},h.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},h.prototype.getLogger=function(){return this.logger},h.prototype.setLogger=function(e){this.logger=e},h.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},h.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},h.prototype.getCurrentConfiguration=function(){if(!this.config)throw a.ClientConfigurationError.createNoSetConfigurationError();return this.config},h.prototype.getTokenType=function(e,t,r){return r?S.Account.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.config.auth.clientId)?H:o:-1<t.indexOf(this.config.auth.clientId)?H:i:S.Account.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.clientId)?H:o:i},h.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):q.Constants.no_account,n=_.AuthCache.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},h.prototype.setAuthorityCache=function(e,t){var r=_.AuthCache.generateAuthorityKey(e);this.cacheStorage.setItem(r,R.UrlUtils.CanonicalizeUri(t),this.inCookie)},h.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(""+q.TemporaryCacheKeys.LOGIN_REQUEST+q.Constants.resourceDelimiter+e.state,n,this.inCookie),r?this.cacheStorage.setItem(""+q.TemporaryCacheKeys.STATE_LOGIN+q.Constants.resourceDelimiter+e.state,e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(""+q.TemporaryCacheKeys.NONCE_IDTOKEN+q.Constants.resourceDelimiter+e.state,e.nonce,this.inCookie)},h.prototype.getAccountId=function(e){return w.StringUtils.isEmpty(e.homeAccountIdentifier)?q.Constants.no_account:e.homeAccountIdentifier},h.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},h.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return s.default.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw a.ClientConfigurationError.createTelemetryConfigError(e);var i={platform:{applicationName:r,applicationVersion:n},clientId:t};return new s.default(i,o,this.logger)},h);function h(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=n.buildConfiguration(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),N.AuthorityFactory.setKnownAuthorities(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),N.AuthorityFactory.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new _.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=R.UrlUtils.urlContainsHash(t);b.WindowUtils.checkIfBackButtonIsPressed(this.cacheStorage),!r||this.getResponseState(t).method===q.Constants.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t)}t.UserAgentApplication=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),c=r(1),n=r(3),u=r(10),o=(Object.defineProperty(a.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),a.prototype.populateQueryParams=function(e,t,r,n){var o={};t&&(t.prompt&&(this.promptValue=t.prompt),t.claimsRequest&&(this.claimsValue=t.claimsRequest),a.isSSOParam(t)&&(o=this.constructUnifiedCacheQueryParameter(t,null))),r&&(o=this.constructUnifiedCacheQueryParameter(null,r)),o=this.addHintParameters(e,o);var i=t?t.extraQueryParameters:null;this.queryParameters=a.generateQueryParametersString(o),this.extraQueryParameters=a.generateQueryParametersString(i,n)},a.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var o=e.account;o.sid?(r=c.SSOTypes.SID,n=o.sid):o.userName&&(r=c.SSOTypes.LOGIN_HINT,n=o.userName)}else e.sid?(r=c.SSOTypes.SID,n=e.sid):e.loginHint&&(r=c.SSOTypes.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(c.Constants.upn)&&(r=c.SSOTypes.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},a.prototype.addHintParameters=function(e,t){return e&&!t[c.SSOTypes.SID]&&(!t[c.SSOTypes.LOGIN_HINT]&&e.sid&&this.promptValue===c.PromptState.NONE?t=this.addSSOParameter(c.SSOTypes.SID,e.sid,t):t[c.SSOTypes.LOGIN_HINT]||!e.userName||n.StringUtils.isEmpty(e.userName)||(t=this.addSSOParameter(c.SSOTypes.LOGIN_HINT,e.userName,t))),t},a.prototype.addSSOParameter=function(e,t,r){if(r=r||{},!t)return r;switch(e){case c.SSOTypes.SID:r[c.SSOTypes.SID]=t;break;case c.SSOTypes.ID_TOKEN:case c.SSOTypes.LOGIN_HINT:r[c.SSOTypes.LOGIN_HINT]=t}return r},a.generateQueryParametersString=function(t,r){var n=null;return t&&Object.keys(t).forEach(function(e){e===c.Constants.domain_hint&&(r||t[c.SSOTypes.SID])||(null==n?n=e+"="+encodeURIComponent(t[e]):n+="&"+e+"="+encodeURIComponent(t[e]))}),n},a.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},a);function a(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=s.CryptoUtils.createNewGuid(),this.scopes=o?o.slice():[t],this.scopes=u.ScopeSet.trimAndConvertArrayToLowerCase(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer=c.libraryVersion(),this.responseType=r,this.redirectUri=n}t.ServerRequestParameters=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),n=r(3),i=(a.decodeJwt=function(e){if(n.StringUtils.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},a.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=o.CryptoUtils.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},a);function a(){}t.TokenUtils=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),s=r(3),n=(c.createAccount=function(e,t){var r,n=e.objectId||e.subject,o=t?t.uid:"",i=t?t.utid:"";return s.StringUtils.isEmpty(o)||s.StringUtils.isEmpty(i)||(r=a.CryptoUtils.base64Encode(o)+"."+a.CryptoUtils.base64Encode(i)),new c(n,r,e.preferredName,e.name,e.claims,e.sid,e.issuer)},c.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},c);function c(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}t.Account=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var l=r(6),h=r(5),o=r(1),n=(d.isInIframe=function(){return window.parent!==window},d.isInPopup=function(){return!(!window.opener||window.opener===window)},d.generateFrameName=function(e,t){return""+e+o.Constants.resourceDelimiter+t},d.monitorWindowForHash=function(a,e,s,c,u){return new Promise(function(t,r){var n=e/d.POLLING_INTERVAL_MS,o=0;c.verbose("monitorWindowForHash polling started");var i=setInterval(function(){if(a.closed)return c.error("monitorWindowForHash window closed"),clearInterval(i),void r(l.ClientAuthError.createUserCancelledError());var e;try{e=a.location.href}catch(e){}if(u)o++;else{if(!e||"about:blank"===e)return;o++}e&&h.UrlUtils.urlContainsHash(e)?(c.verbose("monitorWindowForHash found url in hash"),clearInterval(i),t(a.location.hash)):n<o&&(c.error("monitorWindowForHash unable to find hash in url, timing out"),c.errorPii("monitorWindowForHash polling timed out for url: "+s),clearInterval(i),r(l.ClientAuthError.createTokenRenewalTimeoutError()))},d.POLLING_INTERVAL_MS)})},d.loadFrame=function(n,o,e,i){var a=this;return i.infoPii("LoadFrame: "+o),new Promise(function(t,r){setTimeout(function(){var e=a.loadFrameSync(n,o,i);e?t(e):r("Unable to load iframe with name: "+o)},e)})},d.loadFrameSync=function(e,t,r){var n=d.addHiddenIFrame(t,r);return n?(""!==n.src&&"about:blank"!==n.src||(n.src=e,r.infoPii("Frame Name : "+t+" Navigated to: "+e)),n):null},d.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},d.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},d.getIframeWithHash=function(t){var r=document.getElementsByTagName("iframe");return Array.apply(null,Array(r.length)).map(function(e,t){return r.item(t)}).filter(function(e){try{return e.contentWindow.location.hash===t}catch(e){return!1}})[0]},d.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},d.getPopUpWithHash=function(t){return d.getPopups().filter(function(e){try{return e.location.hash===t}catch(e){return!1}})[0]},d.trackPopup=function(e){d.getPopups().push(e)},d.closePopups=function(){d.getPopups().forEach(function(e){return e.close()})},d.blockReloadInHiddenIframes=function(){if(h.UrlUtils.urlContainsHash(window.location.hash)&&d.isInIframe())throw l.ClientAuthError.createBlockTokenRequestsInHiddenIframeError()},d.checkIfBackButtonIsPressed=function(e){var t=e.getItem(o.TemporaryCacheKeys.REDIRECT_REQUEST);if(t&&!h.UrlUtils.urlContainsHash(window.location.hash)){var r=t.split(o.Constants.resourceDelimiter),n=1<r.length?r[r.length-1]:null;e.resetTempCacheItems(n)}},d.POLLING_INTERVAL_MS=50,d);function d(){}t.WindowUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.parseExpiresIn=function(e){return e=e||"3599",parseInt(e,10)},o.now=function(){return Math.round((new Date).getTime()/1e3)},o);function o(){}t.TimeUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.sendRequestAsync=function(e,t,r){var a=this;return new Promise(function(n,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||300<=i.status)&&o(a.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(a.handleError(i.responseText))}var r={statusCode:i.status,body:t};n(r)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},o.prototype.handleError=function(t){var e;try{if((e=JSON.parse(t)).error)return e.error;throw t}catch(e){return t}},o);function o(){}t.XhrClient=n},function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=n.__importDefault(t(12)),i=t(11),a=t(16);r.EVENT_KEYS={HTTP_PATH:i.prependEventNamePrefix("http_path"),USER_AGENT:i.prependEventNamePrefix("user_agent"),QUERY_PARAMETERS:i.prependEventNamePrefix("query_parameters"),API_VERSION:i.prependEventNamePrefix("api_version"),RESPONSE_CODE:i.prependEventNamePrefix("response_code"),O_AUTH_ERROR_CODE:i.prependEventNamePrefix("oauth_error_code"),HTTP_METHOD:i.prependEventNamePrefix("http_method"),REQUEST_ID_HEADER:i.prependEventNamePrefix("request_id_header"),SPE_INFO:i.prependEventNamePrefix("spe_info"),SERVER_ERROR_CODE:i.prependEventNamePrefix("server_error_code"),SERVER_SUB_ERROR_CODE:i.prependEventNamePrefix("server_sub_error_code"),URL:i.prependEventNamePrefix("url")};var s,c=(s=o.default,n.__extends(u,s),Object.defineProperty(u.prototype,"url",{set:function(e){var t=i.scrubTenantFromUri(e);this.event[r.EVENT_KEYS.URL]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"httpPath",{set:function(e){this.event[r.EVENT_KEYS.HTTP_PATH]=i.scrubTenantFromUri(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"userAgent",{set:function(e){this.event[r.EVENT_KEYS.USER_AGENT]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"queryParams",{set:function(e){this.event[r.EVENT_KEYS.QUERY_PARAMETERS]=a.ServerRequestParameters.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"apiVersion",{set:function(e){this.event[r.EVENT_KEYS.API_VERSION]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"httpResponseStatus",{set:function(e){this.event[r.EVENT_KEYS.RESPONSE_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"oAuthErrorCode",{set:function(e){this.event[r.EVENT_KEYS.O_AUTH_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"httpMethod",{set:function(e){this.event[r.EVENT_KEYS.HTTP_METHOD]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"requestIdHeader",{set:function(e){this.event[r.EVENT_KEYS.REQUEST_ID_HEADER]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"speInfo",{set:function(e){this.event[r.EVENT_KEYS.SPE_INFO]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"serverErrorCode",{set:function(e){this.event[r.EVENT_KEYS.SERVER_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"serverSubErrorCode",{set:function(e){this.event[r.EVENT_KEYS.SERVER_SUB_ERROR_CODE]=e},enumerable:!0,configurable:!0}),u);function u(e,t){return s.call(this,i.prependEventNamePrefix("http_event"),e,t)||this}r.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var c=r(0),n=r(13),o=r(5),u={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return o.UrlUtils.getCurrentUrl()},postLogoutRedirectUri:function(){return o.UrlUtils.getCurrentUrl()},navigateToLoginRequestUrl:!0},l={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},h={logger:new n.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},d={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};t.buildConfiguration=function(e){var t=e.auth,r=e.cache,n=void 0===r?{}:r,o=e.system,i=void 0===o?{}:o,a=e.framework,s=void 0===a?{}:a;return{auth:c.__assign({},u,t),cache:c.__assign({},l,n),system:c.__assign({},h,i),framework:c.__assign({},d,s)}}},function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(14);r.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};var i,a=(i=o.ServerError,n.__extends(s,i),s.isInteractionRequiredError=function(e){var t=[r.InteractionRequiredAuthErrorMessage.interactionRequired.code,r.InteractionRequiredAuthErrorMessage.consentRequired.code,r.InteractionRequiredAuthErrorMessage.loginRequired.code];return e&&-1<t.indexOf(e)},s.createLoginRequiredAuthError=function(e){return new s(r.InteractionRequiredAuthErrorMessage.loginRequired.code,e)},s.createInteractionRequiredAuthError=function(e){return new s(r.InteractionRequiredAuthErrorMessage.interactionRequired.code,e)},s.createConsentRequiredAuthError=function(e){return new s(r.InteractionRequiredAuthErrorMessage.consentRequired.code,e)},s);function s(e,t){var r=i.call(this,e,t)||this;return r.name="InteractionRequiredAuthError",Object.setPrototypeOf(r,s.prototype),r}r.InteractionRequiredAuthError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponseStateOnly=function(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0});var o,i,a,s,c=r(0),u=c.__importDefault(r(12)),l=r(9),h=r(11);t.EVENT_KEYS={AUTHORITY:h.prependEventNamePrefix("authority"),AUTHORITY_TYPE:h.prependEventNamePrefix("authority_type"),PROMPT:h.prependEventNamePrefix("ui_behavior"),TENANT_ID:h.prependEventNamePrefix("tenant_id"),USER_ID:h.prependEventNamePrefix("user_id"),WAS_SUCESSFUL:h.prependEventNamePrefix("was_successful"),API_ERROR_CODE:h.prependEventNamePrefix("api_error_code"),LOGIN_HINT:h.prependEventNamePrefix("login_hint")},(i=o=t.API_CODE||(t.API_CODE={}))[i.AcquireTokenRedirect=2001]="AcquireTokenRedirect",i[i.AcquireTokenSilent=2002]="AcquireTokenSilent",i[i.AcquireTokenPopup=2003]="AcquireTokenPopup",i[i.LoginRedirect=2004]="LoginRedirect",i[i.LoginPopup=2005]="LoginPopup",i[i.Logout=2006]="Logout",(s=a=t.API_EVENT_IDENTIFIER||(t.API_EVENT_IDENTIFIER={})).AcquireTokenRedirect="AcquireTokenRedirect",s.AcquireTokenSilent="AcquireTokenSilent",s.AcquireTokenPopup="AcquireTokenPopup",s.LoginRedirect="LoginRedirect",s.LoginPopup="LoginPopup",s.Logout="Logout";var d,p=((n={})[a.AcquireTokenSilent]=o.AcquireTokenSilent,n[a.AcquireTokenPopup]=o.AcquireTokenPopup,n[a.AcquireTokenRedirect]=o.AcquireTokenRedirect,n[a.LoginPopup]=o.LoginPopup,n[a.LoginRedirect]=o.LoginRedirect,n[a.Logout]=o.Logout,n),f=(d=u.default,c.__extends(g,d),Object.defineProperty(g.prototype,"apiEventIdentifier",{set:function(e){this.event[l.TELEMETRY_BLOB_EVENT_NAMES.ApiTelemIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"apiCode",{set:function(e){this.event[l.TELEMETRY_BLOB_EVENT_NAMES.ApiIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"authority",{set:function(e){this.event[t.EVENT_KEYS.AUTHORITY]=h.scrubTenantFromUri(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"apiErrorCode",{set:function(e){this.event[t.EVENT_KEYS.API_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"tenantId",{set:function(e){this.event[t.EVENT_KEYS.TENANT_ID]=this.piiEnabled&&e?h.hashPersonalIdentifier(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"accountId",{set:function(e){this.event[t.EVENT_KEYS.USER_ID]=this.piiEnabled&&e?h.hashPersonalIdentifier(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"wasSuccessful",{get:function(){return!0===this.event[t.EVENT_KEYS.WAS_SUCESSFUL]},set:function(e){this.event[t.EVENT_KEYS.WAS_SUCESSFUL]=e},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"loginHint",{set:function(e){this.event[t.EVENT_KEYS.LOGIN_HINT]=this.piiEnabled&&e?h.hashPersonalIdentifier(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"authorityType",{set:function(e){this.event[t.EVENT_KEYS.AUTHORITY_TYPE]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"promptType",{set:function(e){this.event[t.EVENT_KEYS.PROMPT]=e.toLowerCase()},enumerable:!0,configurable:!0}),g);function g(e,t,r){var n=d.call(this,h.prependEventNamePrefix("api_event"),e,r)||this;return r&&(n.apiCode=p[r],n.apiEventIdentifier=r),n.piiEnabled=t,n}t.default=f},function(e,t,r){e.exports=r(28)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(15);t.UserAgentApplication=n.UserAgentApplication,t.authResponseCallback=n.authResponseCallback,t.errorReceivedCallback=n.errorReceivedCallback,t.tokenReceivedCallback=n.tokenReceivedCallback;var o=r(13);t.Logger=o.Logger;var i=r(13);t.LogLevel=i.LogLevel;var a=r(18);t.Account=a.Account;var s=r(1);t.Constants=s.Constants,t.ServerHashParamKeys=s.ServerHashParamKeys;var c=r(8);t.Authority=c.Authority;var u=r(15);t.CacheResult=u.CacheResult;var l=r(23);t.CacheLocation=l.CacheLocation,t.Configuration=l.Configuration;var h=r(43);t.AuthenticationParameters=h.AuthenticationParameters;var d=r(25);t.AuthResponse=d.AuthResponse;var p=r(2);t.CryptoUtils=p.CryptoUtils;var f=r(5);t.UrlUtils=f.UrlUtils;var g=r(19);t.WindowUtils=g.WindowUtils;var y=r(7);t.AuthError=y.AuthError;var m=r(6);t.ClientAuthError=m.ClientAuthError;var E=r(14);t.ServerError=E.ServerError;var v=r(4);t.ClientConfigurationError=v.ClientConfigurationError;var C=r(24);t.InteractionRequiredAuthError=C.InteractionRequiredAuthError},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,r,n,o){this.authority=a.UrlUtils.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=i.CryptoUtils.base64Encode(n)+"."+i.CryptoUtils.base64Encode(o)}var i=r(2),a=r(5);t.AccessTokenKey=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}t.AccessTokenValue=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(6),i=r(3),a=(Object.defineProperty(s.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),s);function s(e){if(!e||i.StringUtils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.CryptoUtils.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw o.ClientAuthError.createClientInfoDecodingError(e)}}t.ClientInfo=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});function n(e){if(a.StringUtils.isEmpty(e))throw o.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=i.TokenUtils.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw o.ClientAuthError.createIdTokenParsingError(e)}}var o=r(6),i=r(17),a=r(3);t.IdToken=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var s,n=r(0),c=r(1),u=r(34),o=r(35),l=r(6),i=(s=o.BrowserStorage,n.__extends(a,s),a.prototype.migrateCacheEntries=function(r){var n=this,e=c.Constants.cachePrefix+"."+c.PersistentCacheKeys.IDTOKEN,t=c.Constants.cachePrefix+"."+c.PersistentCacheKeys.CLIENT_INFO,o=c.Constants.cachePrefix+"."+c.ErrorCacheKeys.ERROR,i=c.Constants.cachePrefix+"."+c.ErrorCacheKeys.ERROR_DESC,a=[s.prototype.getItem.call(this,e),s.prototype.getItem.call(this,t),s.prototype.getItem.call(this,o),s.prototype.getItem.call(this,i)];[c.PersistentCacheKeys.IDTOKEN,c.PersistentCacheKeys.CLIENT_INFO,c.ErrorCacheKeys.ERROR,c.ErrorCacheKeys.ERROR_DESC].forEach(function(e,t){return n.duplicateCacheEntry(e,a[t],r)})},a.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},a.prototype.generateCacheKey=function(t,r){try{return JSON.parse(t),t}catch(e){return 0===t.indexOf(""+c.Constants.cachePrefix)||0===t.indexOf(c.Constants.adalIdToken)?t:r?c.Constants.cachePrefix+"."+this.clientId+"."+t:c.Constants.cachePrefix+"."+t}},a.prototype.setItem=function(e,t,r,n){s.prototype.setItem.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&s.prototype.setItem.call(this,this.generateCacheKey(e,!1),t,r)},a.prototype.getItem=function(e,t){return s.prototype.getItem.call(this,this.generateCacheKey(e,!0),t)},a.prototype.removeItem=function(e){s.prototype.removeItem.call(this,this.generateCacheKey(e,!0)),this.rollbackEnabled&&s.prototype.removeItem.call(this,this.generateCacheKey(e,!1))},a.prototype.resetCacheItems=function(){var e,t=window[this.cacheLocation];for(e in t)t.hasOwnProperty(e)&&-1!==e.indexOf(c.Constants.cachePrefix)&&s.prototype.removeItem.call(this,e)},a.prototype.resetTempCacheItems=function(e){var t,r=window[this.cacheLocation];for(t in r)e&&-1===t.indexOf(e)||this.tokenRenewalInProgress(e)||(this.removeItem(t),this.setItemCookie(t,"",-1),this.clearMsalCookie(e));this.removeItem(c.TemporaryCacheKeys.INTERACTION_STATUS),this.removeItem(c.TemporaryCacheKeys.REDIRECT_REQUEST)},a.prototype.setItemCookie=function(e,t,r){s.prototype.setItemCookie.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&s.prototype.setItemCookie.call(this,this.generateCacheKey(e,!1),t,r)},a.prototype.getItemCookie=function(e){return s.prototype.getItemCookie.call(this,this.generateCacheKey(e,!0))},a.prototype.getAllAccessTokens=function(i,a){var s=this;return Object.keys(window[this.cacheLocation]).reduce(function(e,t){if(t.match(i)&&t.match(a)&&t.match(c.Constants.scopes)){var r=s.getItem(t);if(r)try{var n=JSON.parse(t),o=new u.AccessTokenCacheItem(n,JSON.parse(r));return e.concat([o])}catch(e){throw l.ClientAuthError.createCacheParseError(t)}}return e},[])},a.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(c.TemporaryCacheKeys.RENEW_STATUS+"|"+e);return!(!t||t!==c.Constants.inProgress)},a.prototype.clearMsalCookie=function(e){this.clearItemCookie(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e),this.clearItemCookie(c.TemporaryCacheKeys.STATE_LOGIN+"|"+e),this.clearItemCookie(c.TemporaryCacheKeys.LOGIN_REQUEST+"|"+e),this.clearItemCookie(c.TemporaryCacheKeys.STATE_ACQ_TOKEN+"|"+e)},a.generateAcquireTokenAccountKey=function(e,t){return""+c.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+c.Constants.resourceDelimiter+e+c.Constants.resourceDelimiter+t},a.generateAuthorityKey=function(e){return""+c.TemporaryCacheKeys.AUTHORITY+c.Constants.resourceDelimiter+e},a);function a(e,t,r){var n=s.call(this,t)||this;return n.clientId=e,n.rollbackEnabled=!0,n.migrateCacheEntries(r),n}t.AuthCache=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){this.key=e,this.value=t}t.AccessTokenCacheItem=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(7),i=(a.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},a.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},a.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},a.prototype.clear=function(){return window[this.cacheLocation].clear()},a.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},a.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},a.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},a.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},a);function a(e){if(!window)throw o.AuthError.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw n.ClientConfigurationError.createStorageNotSupportedError(e);this.cacheLocation=e}t.BrowserStorage=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var c=r(0),n=r(1),u=r(4),l=r(10),o=r(3),i=r(2),a=r(20),s=r(6),h=(d.validateRequest=function(e,t,r,n){if(!t&&!e)throw u.ClientConfigurationError.createEmptyRequestError();var o,i;e&&(o=t?l.ScopeSet.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,l.ScopeSet.validateInputScope(o,!t,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return c.__assign({},e,{extraQueryParameters:i,scopes:o,state:a,correlationId:s})},d.validatePromptParameter=function(e){if(e&&[n.PromptState.LOGIN,n.PromptState.SELECT_ACCOUNT,n.PromptState.CONSENT,n.PromptState.NONE].indexOf(e)<0)throw u.ClientConfigurationError.createInvalidPromptError(e)},d.validateEQParameters=function(e,t){var r=c.__assign({},e);return r?(t&&delete r[n.Constants.claims],n.BlacklistedEQParams.forEach(function(e){r[e]&&delete r[e]}),r):null},d.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw u.ClientConfigurationError.createClaimsRequestParsingError(e)}},d.validateAndGenerateState=function(e,t){return o.StringUtils.isEmpty(e)?d.generateLibraryState(t):""+d.generateLibraryState(t)+n.Constants.resourceDelimiter+e},d.generateLibraryState=function(e){var t={id:i.CryptoUtils.createNewGuid(),ts:a.TimeUtils.now(),method:e},r=JSON.stringify(t);return i.CryptoUtils.base64Encode(r)},d.parseLibraryState=function(t){var e=decodeURIComponent(t).split(n.Constants.resourceDelimiter)[0];if(i.CryptoUtils.isGuid(e))return{id:e,ts:a.TimeUtils.now(),method:n.Constants.interactionTypeRedirect};try{var r=i.CryptoUtils.base64Decode(e);return JSON.parse(r)}catch(e){throw s.ClientAuthError.createInvalidStateError(t,null)}},d.validateAndGenerateCorrelationId=function(e){if(e&&!i.CryptoUtils.isGuid(e))throw u.ClientConfigurationError.createInvalidCorrelationIdError();return i.CryptoUtils.isGuid(e)?e:i.CryptoUtils.createNewGuid()},d.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+n.Constants.resourceDelimiter+e.authority},d);function d(){}t.RequestUtils=h},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=(i.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.__assign({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},i);function i(){}t.ResponseUtils=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=r(39),o=r(40),a=r(8),s=r(3),c=r(5),u=r(4),l=(h.setKnownAuthorities=function(e,t){e&&!Object.keys(o.B2CTrustedHostList).length&&t.forEach(function(e){o.B2CTrustedHostList[e]=e})},h.saveMetadataFromNetwork=function(r,n,o){return i.__awaiter(this,void 0,Promise,function(){var t;return i.__generator(this,function(e){switch(e.label){case 0:return[4,r.resolveEndpointsAsync(n,o)];case 1:return t=e.sent(),this.metadataMap.set(r.CanonicalAuthority,t),[2,t]}})})},h.getMetadata=function(e){return this.metadataMap.get(e)},h.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw u.ClientConfigurationError.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw u.ClientConfigurationError.createInvalidAuthorityMetadataError()}},h.detectAuthorityFromUrl=function(e){return e=c.UrlUtils.CanonicalizeUri(e),"adfs"===c.UrlUtils.GetUrlComponents(e).PathSegments[0]?a.AuthorityType.Adfs:Object.keys(o.B2CTrustedHostList).length?a.AuthorityType.B2C:a.AuthorityType.Aad},h.CreateInstance=function(e,t,r){if(s.StringUtils.isEmpty(e))return null;switch(r&&this.saveMetadataFromConfig(e,r),h.detectAuthorityFromUrl(e)){case a.AuthorityType.B2C:return new o.B2cAuthority(e,t,this.getMetadata(e));case a.AuthorityType.Aad:return new n.AadAuthority(e,t,this.getMetadata(e));default:throw u.ClientConfigurationError.createInvalidAuthorityTypeError()}},h.metadataMap=new Map,h);function h(){}t.AuthorityFactory=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(8),a=r(21),s=r(1),c=(n=o.Authority,i.__extends(u,n),Object.defineProperty(u.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return u.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),u.prototype.GetOpenIdConfigurationEndpointAsync=function(n,o){return i.__awaiter(this,void 0,Promise,function(){var t,r;return i.__generator(this,function(e){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:(t=new a.XhrClient,r=n.createAndStartHttpEvent(o,"GET",this.AadInstanceDiscoveryEndpointUrl,"AadInstanceDiscoveryEndpoint"),[2,t.sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return r.httpResponseStatus=e.statusCode,n.stopEvent(r),e.body.tenant_discovery_endpoint}).catch(function(e){throw r.serverErrorCode=e,n.stopEvent(r),e})])})})},u.prototype.IsInTrustedHostList=function(e){return s.AADTrustedHostList[e.toLowerCase()]},u.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",u);function u(e,t,r){return n.call(this,e,t,r)||this}t.AadAuthority=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(8),a=r(4);t.B2CTrustedHostList={};var s,c=(s=o.Authority,n.__extends(u,s),Object.defineProperty(u.prototype,"AuthorityType",{get:function(){return i.AuthorityType.B2C},enumerable:!0,configurable:!0}),u.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw a.ClientConfigurationError.createUntrustedAuthorityError()})})},u.prototype.IsInTrustedHostList=function(e){if(this.IsValidationEnabled&&!Object.keys(t.B2CTrustedHostList).length)throw a.ClientConfigurationError.createKnownAuthoritiesNotSetError();return t.B2CTrustedHostList[e.toLowerCase()]},u.B2C_PREFIX="tfp",u);function u(e,t,r){return s.call(this,e,t,r)||this}t.B2cAuthority=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),s=n.__importDefault(r(42)),o=r(1),i=n.__importDefault(r(26)),a=n.__importDefault(r(22)),c=(u.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},u.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},u.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},u.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new s.default(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},u.prototype.createAndStartApiEvent=function(e,t){var r=new i.default(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},u.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},u.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new a.default(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},u.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},u.prototype.getOrphanedEvents=function(n){var o=this;return Object.keys(this.inProgressEvents).reduce(function(e,t){if(-1===t.indexOf(n))return e;var r=o.inProgressEvents[t];return delete o.inProgressEvents[t],e.concat([r])},[])},u);function u(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=n.__assign({sdk:o.Constants.libraryName,sdkVersion:o.libraryVersion(),networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}t.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i,n=r(0),a=r(9),o=n.__importDefault(r(12)),s=r(11),c=(i=o.default,n.__extends(u,i),u.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},u);function u(e,t,r,n){var o=i.call(this,s.prependEventNamePrefix("default_event"),t,"DefaultEvent")||this;return o.event[s.prependEventNamePrefix("client_id")]=r,o.event[s.prependEventNamePrefix("sdk_plaform")]=e.sdk,o.event[s.prependEventNamePrefix("sdk_version")]=e.sdkVersion,o.event[s.prependEventNamePrefix("application_name")]=e.applicationName,o.event[s.prependEventNamePrefix("application_version")]=e.applicationVersion,o.event[s.prependEventNamePrefix("effective_connection_speed")]=e.networkInformation&&e.networkInformation.connectionSpeed,o.event[""+a.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=o.getEventCount(s.prependEventNamePrefix("ui_event"),n),o.event[""+a.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=o.getEventCount(s.prependEventNamePrefix("http_event"),n),o.event[""+a.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=o.getEventCount(s.prependEventNamePrefix("cache_event"),n),o}t.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.validateClaimsRequest=function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw n.ClientConfigurationError.createClaimsRequestParsingError(e)}}}],o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=27);function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var r,n});
//# sourceMappingURL=msal.min.js.map